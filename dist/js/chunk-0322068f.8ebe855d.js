(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0322068f"],{"0622":function(t,e,a){"use strict";var i=a("be18"),n=a.n(i);n.a},"24ca":function(t,e,a){"use strict";var i=a("b775");e["a"]={saveCreateDiagnosesBill:function(t){return i["a"].post("/Bill/createNew/saveCreateDiagnosesBill",t)},saveCreateBillJ007:function(t){return i["a"].post("/Bill/createNew/saveCreateBillJ007",t)},getCreateNew:function(t){return i["a"].post("/Bill/CreateNew",t)},getFaultPhenomenon:function(t){return i["a"].post("/Bill/CreateNew/getFaultPhenomenon",t)},addFaultPhenomenon:function(t){return i["a"].post("/Bill/CreateNew/addFaultPhenomenon",t)},checkRestrict:function(t){return i["a"].post("/Bill/CreateNew/checkRestrict",t)},checkCustomer:function(t){return i["a"].post("/Bill/CreateNew/checkCustomer",t)},getCarInfoByVin:function(t){return i["a"].post("/Bill/CreateNew/getCarInfoByVin",t)},getBillDetail:function(t){return i["a"].post("/Bill/Undisposed/getBillDetail",t)},getReferee:function(t){return i["a"].post("/Common/Bill/getReferee",t)},getReportPriceByBillType:function(t){return i["a"].post("/Common/Bill/getReportPriceByBillType",t)},addBillType:function(t){return i["a"].post("/Bill/CreateNew/addBillType",t)},delBillType:function(t){return i["a"].post("/Bill/Undisposed/delBillType",t)},saveCreateBill:function(t){return i["a"].post("/Bill/createNew/saveCreateBill",t)},saveConsulting:function(t){return i["a"].post("/Bill/Undisposed/saveConsulting",t)},getCarConditionByVin:function(t){return i["a"].post("/Bill/Report/getCarConditionByVin",t)},getNowOilList:function(t){return i["a"].post("/Common/InitialSurveyData/getNowOilList",t)}}},4396:function(t,e,a){"use strict";var i=a("5a73"),n=a.n(i);n.a},"5a73":function(t,e,a){},"87d9":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"header-one"},[a("van-nav-bar",{class:{"clear-background":t.backgroundStatus,"border-bottom":t.isborderBottom},attrs:{"z-index":999,fixed:t.isFixed,border:!0,title:t.title,"left-text":t.leftText,"right-text":t.rightText,"left-arrow":t.leftArrow},on:{"click-left":function(e){return t.onClickLeft()},"click-right":t.onClickRight}},["icon"==t.rightText?a("van-icon",{staticClass:"icon-right",attrs:{slot:"right",color:"#000",name:t.iconName},slot:"right"}):t._e()],1),a("van-row",{class:{"header-fixed-margin":t.isFixed,"header-fixed-margin-hide":!t.isFixed}})],1)},n=[],s=(a("c3a6"),a("ad06")),r=(a("68ef"),a("8a0b"),a("2638")),c=a.n(r),l=a("a142"),o=a("ba31"),u=Object(l["j"])("nav-bar"),d=u[0],f=u[1];function h(t,e,a,i){return t("div",c()([{class:[f({fixed:e.fixed}),{"van-hairline--bottom":e.border}],style:{zIndex:e.zIndex}},Object(o["b"])(i)]),[t("div",{class:f("left"),on:{click:i.listeners["click-left"]||l["h"]}},[a.left?a.left():[e.leftArrow&&t(s["a"],{class:f("arrow"),attrs:{name:"arrow-left"}}),e.leftText&&t("span",{class:f("text")},[e.leftText])]]),t("div",{class:[f("title"),"van-ellipsis"]},[a.title?a.title():e.title]),t("div",{class:f("right"),on:{click:i.listeners["click-right"]||l["h"]}},[a.right?a.right():e.rightText&&t("span",{class:f("text")},[e.rightText])])])}h.props={title:String,fixed:Boolean,leftText:String,rightText:String,leftArrow:Boolean,border:{type:Boolean,default:!0},zIndex:{type:Number,default:1}};var p,v=d(h),g=a("9ef6");function m(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var C={name:"HeaderOne",data:function(){return{}},components:(p={},m(p,v.name,v),m(p,s["a"].name,s["a"]),p),props:{title:{type:String,default:""},isFixed:{type:Boolean,default:!1},backgroundStatus:{type:Boolean,default:!1},leftText:{type:String,default:""},rightText:{type:String,default:""},leftArrow:{type:Boolean,default:!0},onClickLeftStatus:{type:Boolean,default:!1},isborderBottom:{type:Boolean,default:!1},iconName:{type:String,default:"share"}},mounted:function(){},methods:{onClickLeft:function(){this.onClickLeftStatus?this.$emit("onClickLeft"):g["a"].handle()},onClickRight:function(){this.$emit("onClickRight")}}},b=C,w=(a("0622"),a("2877")),_=Object(w["a"])(b,i,n,!1,null,null,null);e["a"]=_.exports},"8a0b":function(t,e,a){},afa6:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("headerOne",{attrs:{title:t.$route.meta.title,isFixed:!0,backgroundStatus:!0}}),a("div",{staticClass:"depthDiagnosis"},[a("div",{staticClass:"price"},[a("van-row",{staticClass:"title",attrs:{type:"flex"}},[a("van-col",{attrs:{span:"20"}},[t._v("诊断费用")]),t.isSelfShop&&(t.priceData.origin_price||t.priceData.discount_info.length)?a("van-col",{staticClass:"right-side price-btn",attrs:{span:"4"},nativeOn:{click:function(e){t.isPriceDetailShow=!t.isPriceDetailShow}}},[t._v(t._s(t.isPriceDetailShow?"收起":"明细"))]):t._e()],1),a("ul",{directives:[{name:"show",rawName:"v-show",value:t.isPriceDetailShow&&t.isSelfShop,expression:"isPriceDetailShow && isSelfShop"}],staticClass:"price-container"},[t.priceData.origin_price?a("li",[a("van-row",{staticClass:"price-detail",attrs:{type:"flex",justify:"space-between",align:"center"}},[a("van-col",{attrs:{span:"20"}},[t._v("深度诊断原价")]),a("van-col",{staticClass:"right-side",attrs:{span:"6"}},[t._v(t._s(t.priceData.origin_price)+" 元")])],1)],1):t._e(),t.priceData.discount_info.length?a("li",t._l(t.priceData.discount_info,function(e,i){return a("van-row",{key:i,staticClass:"price-detail",attrs:{type:"flex",justify:"space-between",align:"center"}},[a("van-col",{attrs:{span:"20"}},[t._v(t._s(e.discount_name))]),a("van-col",{staticClass:"right-side",attrs:{span:"6"}},[t._v("-"+t._s(e.discount_price)+" 元")])],1)}),1):t._e()]),a("van-row",{staticClass:"total",attrs:{type:"flex",justify:"space-between",align:"center"}},[a("van-col",{attrs:{span:"20"}},[t._v("合计")]),a("van-col",{staticClass:"right-side",attrs:{span:"6"}},[t._v(t._s(t.price)+" 元")])],1)],1),a("div",{staticClass:"faultSearch"},[a("van-row",{staticClass:"title"},[t._v("故障现象")]),a("van-row",{staticClass:"detail",attrs:{type:"flex",justify:"space-between",align:"center"}},[a("van-col",{attrs:{span:"20"}},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.searchFaultCode,expression:"searchFaultCode",modifiers:{trim:!0}}],ref:"searchInput",attrs:{type:"text",placeholder:"输入故障码/故障现象"},domProps:{value:t.searchFaultCode},on:{input:[function(e){e.target.composing||(t.searchFaultCode=e.target.value.trim())},function(e){return t.searchFault(t.searchFaultCode)}],blur:function(e){return t.$forceUpdate()}}})]),a("van-col",{directives:[{name:"show",rawName:"v-show",value:t.searchFaultCode,expression:"searchFaultCode"}],staticClass:"close"},[a("van-icon",{attrs:{name:"clear"},on:{click:t.clearSearchValue}})],1)],1),a("ul",{staticClass:"searchResultList"},[t._l(t.searchFaultResult,function(e,i){return a("li",{key:i,on:{click:function(a){return t.addSelectedFault(e.fault)}}},[t._v(t._s(e.fault))])}),t.canShowResult&&0==t.searchFaultResult.length&&!t.isSelfShop?a("div",{staticClass:"noResult"},[t._v("未匹配到相关结果")]):t._e(),t.canShowResult&&0==t.searchFaultResult.length&&t.isSelfShop?a("div",{staticClass:"noResult"},[t._v("\n                    未匹配到相关结果，\n                    "),a("span",{staticClass:"jns-input",on:{click:function(e){return t.addSelectedFault(t.searchFaultCode)}}},[t._v('直接使用"'+t._s(t.searchFaultCode)+'"')])]):t._e()],2)],1),t.selectedFaultList.length>0?a("div",{staticClass:"faultSelected"},[a("van-row",{staticClass:"title"},[t._v("车况描述")]),a("ul",{staticClass:"selectedFaultList"},t._l(t.selectedFaultList,function(e,i){return a("li",{key:i},[a("van-row",{attrs:{type:"flex",justify:"space-between",align:"center"}},[a("van-col",{attrs:{span:"22"}},[t._v(t._s(e))]),a("van-col",{staticClass:"close",attrs:{span:"2"}},[a("van-icon",{attrs:{name:"cross"},on:{click:function(e){return t.removeSelectedFault(i)}}})],1)],1)],1)}),0)],1):t._e(),a("div",{staticClass:"btn",on:{click:t.next}},[t.selectedFaultList.length>0?a("div",{staticClass:"next-btn"},[t._v("下一步")]):t._e()])])],1)},n=[],s=a("87d9"),r=a("e17b"),c=a("b775"),l={getFaultCode:function(t){return c["a"].post("/Helper/DepthDiagnosis/index",t)},getSystemQuote:function(t){return c["a"].post("/Helper/DepthDiagnosis/getSystemQuote",t)}},o=a("24ca"),u=a("cf45"),d={components:{headerOne:s["a"]},data:function(){return{carInfo:{},searchFaultCode:"",searchFaultResult:[],selectedFaultList:[],price:"0.00",priceData:{origin_price:"",discount_info:[]},canNext:!0,isSelfShop:!1,isPriceDetailShow:!1,canShowResult:!1}},methods:{searchFault:function(t){if(t){this.searchFaultCode=t;var e=Object(u["d"])(this.searchFaultFromServer,200);e(this.searchFaultCode)}else this.searchFaultResult=[]},clearSearchValue:function(){this.searchFaultCode="",this.searchFaultResult=[],this.canShowResult=!1},strLenCheck:function(t){var e=new RegExp("[\\u4E00-\\u9FFF]+","g");if(e.test(t)){if(t.length>=2)return!0}else if(t.length>=5)return!0},searchFaultFromServer:function(t){var e=this,a=this.strLenCheck(t);if(a){var i={keyword:t,car_brand:this.carInfo.carBrandName,car_line:this.carInfo.carLineName,car_cc:this.carInfo.carCc,car_cc_unit:this.carInfo.unit};l.getFaultCode(i).then(function(t){2e4==t.code&&(e.searchFaultResult=t.data.list,e.isSelfShop="1"==t.data.is_jns,e.canShowResult=!0)})}else this.canShowResult=!1},addSelectedFault:function(t){this.$toast.clear(),this.selectedFaultList.includes(t)?this.$toast({message:"该故障现象已选择",duration:1e3}):(this.selectedFaultList.push(t),this.getPrice(),this.clearSearchValue())},removeSelectedFault:function(t){this.selectedFaultList.splice(t,1),this.selectedFaultList.length>0?this.getPrice():(this.price="0.00",this.priceData.origin_price="",this.priceData.discount_info=[],this.isPriceDetailShow=!1)},getPrice:function(){for(var t=this,e={vin:this.carInfo.vin,car_brand:this.carInfo.carBrandName,car_line:this.carInfo.carLineName,car_cc:this.carInfo.carCc,car_cc_unit:this.carInfo.unit},a=0;a<this.selectedFaultList.length;a++)e["fault_list[".concat(a,"]")]=this.selectedFaultList[a];l.getSystemQuote(e).then(function(e){2e4==e.code&&(t.price=e.data.pay_price,t.priceData=e.data)})},next:function(){var t=this;if(this.canNext){this.canNext=!1;var e=this.$session.get("carInfo");e.carStyle=e["nianKuan"],delete e["nianKuan"],e.carBrandLogo=e["icoName"],delete e["icoName"],e.carCc=e.carCc+e.unit,e.tripDistance=e["carKm"],delete e["carKm"],e.carModelId?e.carType=0:e.carType=1;var a=this.selectedFaultList.join(","),i={baseInfo:e,faultPhenomenonDescs:a};o["a"].saveCreateDiagnosesBill(i).then(function(e){if(t.canNext=!0,2e4==e.code){var a={bill_id:e.data.billStatus.billId,bill_type:"J005"};r["a"].h5ToApp(e.data.billStatus.nextStatusCode,a)}else t.$toast.fail(e.msg)})}}},mounted:function(){var t=this;this.$nextTick(function(){t.$refs["searchInput"].focus()}),this.carInfo=this.$session.get("carInfo"),this.carInfo.icoName&&(this.iconShow=!0)}},f=d,h=(a("4396"),a("2877")),p=Object(h["a"])(f,i,n,!1,null,"ec984398",null);e["default"]=p.exports},b775:function(t,e,a){"use strict";a("e7e5");var i=a("d399"),n=a("bc3a"),s=a.n(n),r=a("4328"),c=a.n(r),l=a("e17b"),o=a("5f87"),u=a("cf45"),d=s.a.create({baseURL:"https://api.wanguoqiche.com",timeout:5e3,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(t){return t=c.a.stringify(t),t}]}),f={handle:function(t){Object(u["j"])()||!Object(o["a"])()?t&&t():setTimeout(function(){l["a"].backHome()},1e3)},40500:function(t){Object(i["a"])({type:"fail",message:t,duration:1e3}),this.handle()},40300:function(t){Object(i["a"])({type:"fail",message:t,duration:1e3}),this.handle()},40600:function(t){Object(i["a"])({type:"fail",message:t,duration:1e3}),this.handle()},40100:function(t){Object(i["a"])({type:"fail",message:t,duration:1e3}),setTimeout(function(){if(Object(o["b"])()&&Object(o["d"])(),Object(u["j"])())return location.reload(),!0;l["a"].jumpLogin()},1e3)},40400:function(t){Object(i["a"])({type:"fail",message:t,duration:1e3})},40000:function(){return!0}};d.interceptors.request.use(function(t){return void 0===t.data&&(t.data={}),t.data.token=Object(o["b"])(),t},function(t){return Promise.reject(t).catch(function(t){return t})}),d.interceptors.response.use(function(t){var e=t.data;return 2e4!==e.code?(f[e.code]&&f[e.code](e.msg),Promise.reject(e).catch(function(t){return t})):e},function(t){return Object(i["a"])({type:"fail",message:t.message}),Promise.reject(t).catch(function(t){return t})}),e["a"]=d},be18:function(t,e,a){}}]);